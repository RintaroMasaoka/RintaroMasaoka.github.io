\RequirePackage{amsmath,unicode-math,physics,xparse,mathcommand,newunicodechar}
\DeclareOption{uprightconst}{\let\conststyle\symup} 
\DeclareOption{italicconst}{\let\conststyle\symit}
\DeclareOption{uprightdiff}{\let\diffstyle\symup} 
\DeclareOption{italicdiff}{\let\diffstyle\symit}
\ExecuteOptions{uprightconst,uprightdiff}
\ProcessOptions\relax

% Math accents
\renewmathcommand{\~}{\tilde}
\renewmathcommand{\.}{\dot}
\renewmathcommand{\"}{\ddot}
\renewmathcommand{\^}{\hat}
\renewmathcommand{\=}{\bar}
\renewmathcommand{\'}{\acute}
\renewmathcommand{\`}{\grave}
\newcommand{\âˆ¨}{\check}
\newcommand{\âˆª}{\breve}
\newcommand{\â†’}{\overrightarrow}
\newcommand{\â†}{\overleftarrow}
\newcommand{\â†”}{\overleftrightarrow}
\newcommand{\â‹¯}{\dddot}
\newcommand{\âˆ˜}{\overcircle}
\newcommand{\?}{\overhook}

% Constants
\newcommand{\e}{\conststyle{e}}
\newunicodechar{â„¯}{\conststyle{e}}
\renewmathcommand{\i}{\conststyle{i}}
\newcommand{\Â¡}{\conststyle{i}}
\newcommand{\Ï€}{\conststyle{Ï€}}
\newcommand{\kB}{k_{\symup{B}}}

% Short commands
\DeclareDocumentCommand{\shortdifferential}{e{^} m}{
    \IfNoValueTF{#1}{\mathinner{\diffstyle{d}#2}}
    {\mathinner{\diffstyle{d}^{#1}#2}}
}
\renewmathcommand{\d}{\shortdifferential}
\newcommand{\â£}{\quad}
\newcommand{\âˆ…}{\nonumber \\}
\newcommand{\Ã·}{\frac}
\newcommand{\âˆš}[1]{\mathinner{\sqrt{#1}}}
\renewcommand{\r}{\right}
\renewcommand{\l}{\left}
\newcommand{\m}{\middle}
\renewmathcommand{\t}{\text}
\newcommand{\R}{\mathrm}
\newcommand{\ğ’Ÿ}[1]{\mathinner{ğ’Ÿ#1}}
\newcommand{\ğ‘‘}[1]{\mathinner{ğ‘‘#1}}

% Dirac braket and matrix
\newcommand{\âŸ¨}{\left\langle}
\newcommand{\âŸ©}{\right\rangle}
\newcommand{\âˆ£}{\middle|}
\newcommand{\â›}{\left(\begin{matrix}}
\newcommand{\â }{\end{matrix}\right)}
\newcommand{\â}{\\}
\newcommand{\â}{}
\newcommand{\âŒˆ}{\left[\begin{matrix}}
\newcommand{\âŒ‹}{\end{matrix}\right]}
\newcommand{\âŒ‰}{\\}
\newcommand{\âŒŠ}{}

% Shorthands of commands from physics
\newcommand{\Q}{\quantity}
\DeclareDocumentCommand{\P}{r()}{\left(#1\right)}
\DeclareDocumentCommand{\B}{r[]}{\left[#1\right]}
\DeclareDocumentCommand{\V}{r||}{\left|#1\right|}
\newcommand{\M}{\mqty}
\newcommand{\E}{\eval}\newcommand{\F}{\fdv}

\NewDocumentCommand{\âˆ‚}{s e{^} t_ m}{
   \IfBooleanTF{#1}
   {\IfBooleanTF{#3}{\diffp[#2]{}/{#4}}{\diffp[#2]{#4}/}}
   {\IfBooleanTF{#3}{\diffp[#2]{}{#4}}{\diffp[#2]{#4}}}
}
\NewDocumentCommand{\Î´}{s e{^} t_ m}{
   \IfBooleanTF{#1}
   {\IfBooleanTF{#3}{\diff.d.[#2]{}/{#4}}{\diff.d.[#2]{#4}/}}
   {\IfBooleanTF{#3}{\diff.d.[#2]{}{#4}}{\diff.d.[#2]{#4}}}
} 
\NewDocumentCommand{\Î”}{s e{^} t_ m}{
   \IfBooleanTF{#1}
   {\IfBooleanTF{#3}{\Diffd[#2]{}/{#4}}{\Diffd[#2]{#4}/}}
   {\IfBooleanTF{#3}{\Diffd[#2]{}{#4}}{\Diffd[#2]{#4}}}
}

% tt commands
\DeclareDocumentCommand{\ğš€}{m}{\left\{#1\right\}}
\DeclareDocumentCommand{\ğ™¿}{r()}{\left(#1\right)}
\DeclareDocumentCommand{\ğ™±}{r[]}{\left[#1\right]}
\DeclareDocumentCommand{\ğš…}{r||}{\left|#1\right|}
\newcommand{\ğ™¼}{\mqty}
\newcommand{\ğ™´}{\eval}
\newcommand{\ğš}{\dv}
\newcommand{\ğ™µ}{\fdv}
\newcommand{\ğš›}{\right}
\newcommand{\ğš•}{\left}
\newcommand{\ğš–}{\middle}
\newcommand{\ğš}{\text}
\newcommand{\ğš}{\mathrm}

% Math operators
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\sign}{sign}
\DeclareMathOperator{\ad}{ad}
\DeclareMathOperator{\Ad}{Ad}
\DeclareMathOperator{\Span}{Span}
\DeclareMathOperator{\Spec}{Spec}
\DeclareMathOperator{\Hom}{Hom}
\DeclareMathOperator{\diag}{diag}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\im}{im}
\newcommand{\SO}{\mathrm{SO}}
\newcommand{\SU}{\mathrm{SU}}
\newcommand{\GL}{\mathrm{GL}}
\newcommand{\SL}{\mathrm{SL}}
\newcommand{\Spin}{\mathrm{Spin}}
\AtBeginDocument{
    \let\Re\relax \DeclareMathOperator\Re{\mathrm{Re}}%
    \let\Im\relax \DeclareMathOperator\Im{\mathrm{Im}}%
}

% Redifinition of old commands
\def\rm{\mathrm}
\def\tt{\mathtt}
\def\it{\mathit}
\def\bf{\mathbf}
\def\sf{\mathsf}

% unicode character redefine
\newunicodechar{â˜…}{\star}
\newunicodechar{â‹¯}{\mathinner{\cdots}}
\newunicodechar{â€¦}{\mathinner{\ldots}}
\newunicodechar{â†‘}{{\uparrow}}
\newunicodechar{â†“}{{\downarrow}}
\newunicodechar{Ä§}{\hbar}
\newunicodechar{Ã·}{\frac}


\newunicodechar{ğ‘}{\symup{a}}
\newunicodechar{ğ‘}{\symup{b}}
\newunicodechar{ğ‘}{\symup{c}}
\newunicodechar{ğ‘‘}{\symup{d}}
\newunicodechar{ğ‘’}{\symup{e}}
\newunicodechar{ğ‘“}{\symup{f}}
\newunicodechar{ğ‘”}{\symup{g}}
\newunicodechar{â„}{\symup{h}}
\newunicodechar{ğ‘–}{\symup{i}}
\newunicodechar{ğ‘—}{\symup{j}}
\newunicodechar{ğ‘˜}{\symup{k}}
\newunicodechar{ğ‘™}{\symup{l}}
\newunicodechar{ğ‘š}{\symup{m}}
\newunicodechar{ğ‘›}{\symup{n}}
\newunicodechar{ğ‘œ}{\symup{o}}
\newunicodechar{ğ‘}{\symup{p}}
\newunicodechar{ğ‘}{\symup{q}}
\newunicodechar{ğ‘Ÿ}{\symup{r}}
\newunicodechar{ğ‘ }{\symup{s}}
\newunicodechar{ğ‘¡}{\symup{t}}
\newunicodechar{ğ‘¢}{\symup{u}}
\newunicodechar{ğ‘£}{\symup{v}}
\newunicodechar{ğ‘¤}{\symup{w}}
\newunicodechar{ğ‘¥}{\symup{x}}
\newunicodechar{ğ‘¦}{\symup{y}}
\newunicodechar{ğ‘§}{\symup{z}}

\newunicodechar{ğ´}{\symup{A}}
\newunicodechar{ğµ}{\symup{B}}
\newunicodechar{ğ¶}{\symup{C}}
\newunicodechar{ğ·}{\symup{D}}
\newunicodechar{ğ¸}{\symup{E}}
\newunicodechar{ğ¹}{\symup{F}}
\newunicodechar{ğº}{\symup{G}}
\newunicodechar{ğ»}{\symup{F}}
\newunicodechar{ğ¼}{\symup{I}}
\newunicodechar{ğ½}{\symup{J}}
\newunicodechar{ğ¾}{\symup{K}}
\newunicodechar{ğ¿}{\symup{L}}
\newunicodechar{ğ‘€}{\symup{M}}
\newunicodechar{ğ‘}{\symup{N}}
\newunicodechar{ğ‘‚}{\symup{O}}
\newunicodechar{ğ‘ƒ}{\symup{P}}
\newunicodechar{ğ‘„}{\symup{Q}}
\newunicodechar{ğ‘…}{\symup{R}}
\newunicodechar{ğ‘†}{\symup{S}}
\newunicodechar{ğ‘‡}{\symup{T}}
\newunicodechar{ğ‘ˆ}{\symup{U}}
\newunicodechar{ğ‘‰}{\symup{V}}
\newunicodechar{ğ‘Š}{\symup{W}}
\newunicodechar{ğ‘‹}{\symup{X}}
\newunicodechar{ğ‘Œ}{\symup{Y}}
\newunicodechar{ğ‘}{\symup{Z}}

\newunicodechar{ğ›¼}{\symup{\alpha}}
\newunicodechar{ğ›½}{\symup{\beta}}
\newunicodechar{ğ›¾}{\symup{\gamma}}
\newunicodechar{ğ›¿}{\symup{\delta}}
\newunicodechar{ğœ–}{\symup{\epsilon}}
\newunicodechar{ğœ‚}{\symup{\eta}}
\newunicodechar{ğœ‹}{\symup{\pi}}
\newunicodechar{ğœ‰}{\symup{\xi}}
\newunicodechar{ğœ€}{\symup{\varepsilon}}