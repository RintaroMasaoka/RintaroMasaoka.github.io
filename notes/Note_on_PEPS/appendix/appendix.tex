\providecommand{\main}{../main}
\documentclass[\main/main.tex]{subfiles}
\graphicspath{{../images/}}
\begin{document}
\section{標準形}
\begin{definition}[転送行列 (Transfer matrix)]\label{def: transfer matrix}
    テンソル$A ∈ \L(𝒱) ⊗ ℋ$に対して転送行列(transfer matrix) $ℰ_A ∈ \L(𝒱 ⊗ 𝒱)$が以下のように定義される。
    \begin{align}
        ℰ_A ≔ ∑_s A^s ⊗ \＿A^s = \mfig{AstarA}.
    \end{align}
    これを$ℰ_A: \L(𝒱) → \L(𝒱)$として表すと
    \begin{align}
        ℰ_A: X ↦ ∑_s A^s X A^{s†}
    \end{align}
    となる。
\end{definition}

\begin{definition}[Positive map]
    線形写像$ℰ: \L(𝒱) → \L(𝒱)$が半正定値性を保つとき、positive mapであると言う。
\end{definition}

\begin{definition}[既約性 (Irreducibility)]\label{def: irreducible}
    テンソル$A ∈ \L(𝒱)⊗ℋ$が$A^sP = PA^sP$となるような非自明な直交射影$P$を持たないとき、$A$は既約(irreducibile)であるという。
\end{definition}


\begin{definition}[既約性 (Irreducibility)]\label{def: map irreducible}
    線形写像$ℰ:\L(𝒱) → \L(𝒱)$が$ℰ(P \L(𝒱) P) ⊂ P\L(𝒱)P$となるような非自明な直交射影$P$を持たないとき、$ℰ$は既約(irreducibile)であるという。
\end{definition}


\begin{lemma}
    $A$が既約$⇔$ $ℰ_A$が既約
\end{lemma}
\begin{proof}
    まず$⇐$の対偶を示す。$A$が既約でないならば直交射影$P$が存在して
    \begin{align}
        ℰ_A(PXP) = ∑_s A^sPXPA^{s†} = ∑_s PA^sPXPA^{s†}P ∈ P\L(𝒱)P
    \end{align}
    となる。よって$ℰ_A$は既約でない。
    
    次に$⇒$の対偶を示す。
    $ℰ_{A}$が既約でないとき、$ℰ_A(P \L(𝒱) P) ⊂ P\L(𝒱)P$を満たす非自明な直交射影$P$が存在する。
    すると$\im P$の正規直交基底$\{|a⟩\}_a$が存在して
    \begin{align}
    ℰ_A(P) = ∑_a ∑_s A^s |a⟩⟨a| A^{s†} = ∑_a λ_a |a⟩⟨a|
    \end{align}
    と表せる。ここから$\Span\{A^s |a⟩\}_{s,a} = \Span\{|a⟩\}_a$が言える。よって$A^sP = PA^sP$が成り立つ。
\end{proof}
\begin{theorem}[有限次元Krein--Rutmanの定理]\label{thm: Krein-Rutman}
    線形写像$ℰ$がpositiveかつ既約であるとき、
    \begin{enumerate}
        \item $ℰ$のスペクトル半径$ρ_ℰ$は$ℰ$の固有値である。
        \item $ρ_ℰ$は非縮退で固有ベクトルは正定値
        \item $ρ_ℰ$以外の固有値をもつ固有ベクトルは半正定値ではない。
    \end{enumerate}
\end{theorem}

\begin{definition}[強既約性 (Strong irreducibility)]\label{def: strong irreducibility}
   線形写像$ℰ:\L(𝒱) → \L(𝒱)$が以下の条件を満たすとき強既約(strongly irreducibile)であると言う。
    \begin{enumerate}
        \item $ℰ$は\hyperref[def: irreducible]{既約}
        \item $ℰ$の固有値で絶対値がスペクトル半径$ρ_ℰ$に一致するものは$ρ_ℰ$だけであり、かつ$ρ_ℰ$は縮退しない。
    \end{enumerate}
    さらに$ρ_ℰ=1$のとき、正規テンソル(normal tensor)と呼ばれることがある。
    また転送行列$ℰ_A$が強既約なときテンソル$A$が強既約であると言う。
\end{definition}

% \begin{proof}
%     (2. $⇒$ 1.)
%     背理法を用いる。任意の$L$について$\{A^{s₁}⋯A_{s_L}\}$は$\L(𝒱)$を生成しないとする。
%     このときある$B ∈ \L(𝒱)$が存在して、任意の$s₁,…,s_L$に対して$\Tr[A^{s₁}⋯A^{s_L}B] = 0$が成り立つ。
%     \begin{align}
%         \lim_{L → ∞}\Tr_{\L(𝒱)}[(ℰ_A)^L(\＿B ⊗ B)] = \Tr_𝒱[Z'BZB^†] = 0
%     \end{align}
%     一方$Z,Z'$が正定値行列であるから$\Tr[Z'BZB] > 0$である。よって矛盾。
% \end{proof}
\begin{remark}
    以下のゲージ変換に対しMPSは不変
    \begin{align}
        A^s ↦ XA^sX^{-1},␣ X ∈ \GL(𝒱).
    \end{align}
    また周期境界条件が課されているため、$A^s$がブロックごとに三角化されているとき
    \begin{align}
        A^s =\（ A₁^s & * \\ 0 & A₂^s\） ↦ \（ A₁^s & 0 \\ 0 & A₂^s\）
    \end{align}
    としてもTI-MPSは不変。
\end{remark}
\begin{definition}[TI-MPSの標準形 (canonical form)]
    任意のTI-MPS $|ψ(A)⟩$に対し、ゲージ変換と非対角ブロックの削除によって同じ状態を生成する以下のテンソルが得られる。
    \begin{align}
        B^s = ⨁_{a=1}^𝒩 λ_a B_a^s,␣ λ_a ∈ ℂ.
    \end{align}
    これをTI-MPSの標準形 (canonical form)と呼ぶ。
    ただし、各ブロック$B_a$に対する転送行列$ℰ_{B_a}$は以下の条件を満たす。
    \begin{itemize}
        \item $B_a$は\hyperref[def: irreducible]{既約}である。
        \item $ℰ_{B_a}$のスペクトル半径は$1$である。
        \item $ℰ_{B_a}$は右固有ベクトル$ℰ_{B_a}𝟙 = 𝟙$をもつ。
        \item $ℰ_{B_a}$は左固有ベクトル$Λ_a ℰ_{B_a} = Λ_a$をもつ。ここで$Λ_a$は正定値な対角行列である。
    \end{itemize}
\end{definition}
\begin{proof}
    $A$に対し非自明な射影$A^sP = PA^sP$がある場合、
    \begin{align}
        \Tr[A⋯AP] = \Tr[A⋯APAP] = ⋯ = \Tr[PAPA⋯PAP].
        \label{eq: PAPAP}
    \end{align}
    また$A^sP^⊥ = PA^sP^⊥ + P^⊥A^sP^⊥$から
    \begin{align}
        \Tr[A⋯AP^⊥] = \Tr[A⋯APAP^⊥] + \Tr[A⋯AP^⊥AP^⊥].
    \end{align}
    右辺第1項は(\ref{eq: PAPAP})と同様の議論で$\Tr[PAP⋯APAP^⊥] = 0$となるから、
    この変形を繰り返すことで
    \begin{align}
        \Tr[A⋯AP^⊥] =  \Tr[P^⊥AP^⊥A⋯ P^⊥AP^⊥]
    \end{align}
    を得る。よって$A ↦ PAP + P^⊥AP^⊥$と置き換えてよい。
    この操作を繰り返すことで、$A$はブロック対角化されており全てのブロックは既約だと仮定できる。

    次に既約なテンソル$A$に対し一般性を失わずに$ℰ_A$のスペクトル半径を$1$とする。
    $ℰ_A$は既約なpositive mapであるから、\hyperref[thm: Krein-Rutman]{Krein-Rutmanの定理}により最大固有値($=1$)の固有ベクトルは正定値である。
    よって$ℰ_A$の固定点を$X > 0$とし、$B^s ≔ X^{-1/2}A^sX^{1/2}$を考えると
    \begin{align}
        ∑_s B^s 𝟙 B^{s†} = ∑_s X^{-1/2}A^sXA^{s†}X^{-1/2} = 𝟙
    \end{align}
    である。
    次に$X$の対角化を$X = U^†Λ^{1/2}U$とおく。ここで$U$はユニタリ行列で$Λ$は正定値な対角行列である。
    $B^s = U X^{-1/2}A^sX^{1/2}U^† = Λ^{-1/4}UA^sU^†Λ^{1/4} $と置き直すと、
    \begin{align}
        ∑_s B^s 𝟙 B^{s†} = UU^† = 𝟙
    \end{align}
    かつ
    \begin{align}
         ∑_s B^{s†}ΛB^s
         &
         = ∑_s (Λ^{1/4}UA^{s†}U^†Λ^{-1/4})Λ(Λ^{-1/4}UA^sU^†Λ^{1/4}) \∅
         &
         = ∑_s Λ^{1/4}UA^{s†}XA^sU^†Λ^{1/4} \∅
         &
         = Λ
    \end{align}
    となる。
\end{proof}
\begin{definition}[TI-MPSの強い標準形]
    任意のTI-MPS $|ψ(A)⟩$に対し、$p ∈ ℕ$が存在して、$p$個の$A$を連結し、ゲージ変換と非対角ブロックの削除をすることで同じ状態を生成する以下のテンソルが得られる。
    \begin{align}
        B^{s₁,…,s_p} = ⨁_{a=1}^𝒩 λ_a B_a^{s₁,…,s_p},␣ λ_a ∈ ℂ.
    \end{align}
    ただし、各ブロック$B_a$は以下の条件を満たす。
    \begin{itemize}
        \item $B_a$は\hyperref[def: strong irreducibility]{強既約}である。
        \item 転送行列のスペクトル半径は$1$である。
        \item 転送行列$ℰ_{B_a}$は右固有ベクトル$ℰ_{B_a}𝟙 = 𝟙$をもつ。
        \item 転送行列$ℰ_{B_a}$は左固有ベクトル$Λ_a ℰ_{B_a} = Λ_a$をもつ。ここで$Λ_a$は正定値な対角行列である。
    \end{itemize}
\end{definition}
% \begin{proof}
%     大まかなアイディアだけ述べる。
%     一般性を失わずに転送行列$ℰ_A$のスペクトル半径が$1$であると仮定する。
%     CP写像$ℰ$が$𝟙$のみを固定点にもつ場合、$\{ω^k\}_{k=1,…,p}, ω = \exp(2π¡/p)$が全ての絶対値$1$の固有値になるような$p ∈ ℕ$が存在することを示すことができる。
%     よって$p$個の$A$を連結させた$B$を構成すると$ℰ_B$の絶対値$1$の固有値は$1$以外に存在しない。
%     これを既約分解していくことで強い標準形を得る。
% \end{proof}

\begin{theorem}
    以下の2つは同値
    \begin{enumerate}
        \item 有限の長さ$L$が存在して、$\overbrace{A⋯A}^L$が\hyperref[def: injective]{injective}
        \item $A$が\hyperref[def: strong irreducibility]{強既約}
    \end{enumerate}
\end{theorem}

\begin{theorem}[標準形の一意性]\label{thm: uniqueness of CF}
    強既約なテンソル$B ∈ \L(ℂ^D) ⊗ ℋ$に対し$\overbrace{B⋯B}^L$がinjectiveとなるような最小の$L$を$L₀$とする。
    テンソル$B, C ∈ \L(ℂ^D) ⊗ ℋ$から構成されるMPSに対しある$N > 2L₀ + D⁴$が存在して
    \begin{align}
        \Tr[\overbrace{B⋯B}^N]
        =\Tr[\overbrace{C⋯C}^N]
    \end{align}
    ならば、$U ∈ \U(D)$と$ℯ^{¡θ} ∈ \U(1)$が存在して
    \begin{align}
        B^s = ℯ^{¡θ}UC^sU^†
    \end{align}
    が成り立つ。
\end{theorem}
\end{document}