---
import BaseLayout from '../../layouts/BaseLayout.astro';
import NoteCard from '../../components/NoteCard.astro';
import { useTranslations, localize } from '../../i18n/utils';
import { notes as notesData } from '../../utils/data';

const lang = 'en';
const t = useTranslations(lang);

// ノート一覧
const notes = notesData.notes;

// 全タグを抽出（ローカライズ済み）
const allTags = [...new Set(notes.flatMap((n: any) => localize(n.tags, lang) || []))];
---

<BaseLayout title={t('page.notes.title')} lang={lang}>
  <div class="mb-8">
    <h1 class="font-serif text-4xl font-bold text-primary-900 dark:text-primary-50 mb-2">{t('page.notes.title')}</h1>
    <p class="text-primary-500 dark:text-primary-400">{t('page.notes.description')}</p>
  </div>

  <!-- タグフィルター -->
  <div class="mb-8 p-4 bg-white dark:bg-primary-800 rounded-xl border border-primary-100 dark:border-primary-700">
    <p class="text-xs text-primary-400 dark:text-primary-500 uppercase tracking-wider mb-2">{t('ui.topics')}</p>
    <div class="flex flex-wrap gap-2">
      {allTags.map((tag) => (
        <span class="text-sm px-3 py-1 bg-primary-100 dark:bg-primary-700 text-primary-600 dark:text-primary-300 rounded-full">
          {tag}
        </span>
      ))}
    </div>
  </div>

  <!-- ノート一覧 -->
  <div class="grid gap-4">
    {notes.map((note: any) => (
      <NoteCard
        title={localize(note.title, lang)}
        filename={note.filename}
        url={note.url}
        description={localize(note.description, lang)}
        tags={localize(note.tags, lang)}
        lang={lang}
      />
    ))}
  </div>
</BaseLayout>
